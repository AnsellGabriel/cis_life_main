<div class="<%= flex_justify_align('between', 'center') %> gap-1 mb-3">
  <%= content_tag :h4, "Remittances", class: 'text-primary mb-0' %>
  <%== pagy_bootstrap_nav(@pagy) %>
</div>

<table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th class="text-center" scope="col">Status</th>
        <th class="text-center" scope="col">Date</th>
        <th class="text-center" scope="col">MOA #</th>
        <th class="text-center" scope="col">Cooperative</th>
        <th class="text-center" scope="col">Plan</th>
        <th class="text-center" scope="col">Net Premium</th>
      </tr>
    </thead>

    <tbody id="batches_body">
      <% if @payments.present? %>

        <% @payments.each do |payment| %>
          <% payment = payment.decorate %>
          <tr>
            <td class="text-center <%= payment.status_color %>"><%= payment.status.titleize %></td>
            <td class="text-center"><%= month_day_year(payment.payable.date_submitted) %></td>
            <td class="text-center"><%= payment.payable.agreement.moa_no %></td>
            <td><%= payment.payable.agreement.cooperative %></td>
            <td class="text-center"><%= payment.payable.agreement.plan.acronym %></td>
            <td class="text-end"><%= to_curr(payment.payable.coop_net_premium) %></td>
            <td class="text-center">
              <%= link_to payment.receipt.url, class: small_btn('outline-primary'), title: 'View proof of payment' do %>
                <i class="bi bi-eye"></i>
              <% end %>

              <% if payment.rejected? %>
                <%= link_to payment_remark_path(payment, payment.remarks.last), data: {turbo_frame: 'modal'}, class: small_btn('outline-danger'), title: 'Show Remark' do %>
			            <i class="bi bi-card-list"></i>
                <% end %>
              <% else %>
                <% if payment.approved? %>
                  <%= link_to treasury_cashier_entry_path(payment.payable.cashier_entries.last), class: small_btn('outline-success'), title: 'View OR' do %>
                    <i class="bi bi-receipt"></i>
                  <% end %>
                <% else %>
                  <%= link_to new_treasury_cashier_entry_path(gr_id: payment.payable.id), data: {turbo_frame: 'modal'}, class: small_btn('outline-warning text-dark'), title: 'Generate OR' do %>
                    <i class="bi bi-receipt-cutoff"></i>                
                  <% end %>
                  <%= link_to new_payment_remark_path(payment), class: small_btn('outline-danger'), title: 'Reject', data: {turbo_frame: 'modal'} do %>
                    <i class="bi bi-x-lg"></i>               
                  <% end %>
                <% end %>
              <% end %>

            </td>
          </tr>
        <% end %>

      <% else %>
        <tr>
          <td colspan="6" class="text-center">No remittance found</td>
        </tr>
      <% end %>

    </tbody>
  </table>