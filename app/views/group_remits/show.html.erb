<%= turbo_stream_from current_cooperative, "batches" %>

<div class="mb-3">
  <%= link_to 'Group Remits', agreement_group_remits_path(@agreement), class: 'btn btn-secondary' %>
</div>

<div class="d-flex align-items-center gap-1">
  <%= content_tag :h1, "#{@agreement.name}(#{@group_remit.name})" %>
    <% unless @group_remit.submitted? %>
      <% if @all_batches_have_beneficiaries && @batch_count > 4 %>
        <%= link_to 'Submit Batch', submit_group_remit_path(@group_remit),class: 'btn btn-md btn-warning' %>
      <% else %>
        <%= content_tag :button, 'Submit Batch' ,class: 'btn btn-md btn-secondary', disabled: true %>
      <% end %>
    <% end %>
</div>

<div class="d-flex justify-content-between" style="height: auto;">
  <div style="width: 100%">
    <div class="d-flex gap-3">
      <%= content_tag :h6, "Effectivity Date: ", style: "width: 150px" %>
      <%= content_tag :h6, @group_remit.effectivity_date.strftime('%B %d, %Y') %>
    </div>
    <div class="mb-3 d-flex gap-3">
      <%= content_tag :h6, "Expiry Date: ", style: "width: 150px" %>
      <%= content_tag :h6, @group_remit.expiry_date.strftime('%B %d, %Y') %>
    </div>
    <% unless @group_remit.submitted? %>
      <%= turbo_frame_tag "batch_form" do %>
        <%= render "group_remits/add_member" %>
      <% end %>
    <% end%>
  </div>
  <%= turbo_frame_tag "computation" do %>
    <%= render "group_remits/computation" %>
  <% end %>
</div>



<div class="table-responsive">
  <%= turbo_frame_tag "batches" do %>
  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>

        <th class="text-center" scope="col">ID</th>
        <th class="text-center" scope="col">Members</th>
        <th class="text-center" scope="col">Premium</th>
        <th class="text-center" scope="col">Beneficiaries</th>
        <th class="text-center" scope="col">Dependents</th>
        <th class="text-center" scope="col">Actions</th>

      </tr>
    </thead>

    <tbody id="batches_body">
      <% if @group_remit.batches.exists? %>
        <%= render @batches, group_remit: @group_remit %>
      <% end %>
    </tbody>
  </table>

</div>

<%== pagy_bootstrap_nav(@pagy) %>
<% end %>