<%= turbo_stream_from current_cooperative, "batches" %>

<%= content_tag :h1, @group_remit.name %>


<div class="d-flex justify-content-between" style="height: 150px;">
  <div style="width: 100%">
    <div class="d-flex gap-3">
      <%= content_tag :h6, "Effectivity Date: ", style: "width: 150px" %>
      <%= content_tag :h6, @group_remit.effectivity_date.strftime('%B %d, %Y') %>
    </div>
    <div class="mb-3 d-flex gap-3">
      <%= content_tag :h6, "Expiry Date: ", style: "width: 150px" %>
      <%= content_tag :h6, @group_remit.expiry_date.strftime('%B %d, %Y') %>
    </div>
    <%= turbo_frame_tag "batch_form" do %>
      <div>
      <%= link_to new_group_remit_batch_path(@group_remit), data: {turbo_frame: "batch_form"}, class: 'btn btn-primary' do %>
        Add Member
      <% end %>
    <% end %>
  </div>
  </div>

  <div class="">
    <div class="d-flex gap-3">
      <%= content_tag :h6, "Gross Premium: ", style: "width: 200px" %>
      <%= content_tag :h6, "#{number_to_currency(@gross_premium, unit: "₱", precision: 2)}", style: "color: green"%>
    </div>
    <div class="d-flex gap-3">
      <%= content_tag :h6, "Total Coop Commission: ", style: "width: 200px" %>
      <%= content_tag :h6, "(#{number_to_currency(@total_coop_commission, unit: "₱", precision: 2)})", style: "color: red"%>
    </div>
    <div class="d-flex gap-3">
      <%= content_tag :h6, "Total Agent Commission: ", style: "width: 200px" %>
      <%= content_tag :h6, "(#{number_to_currency(@total_agent_commission, unit: "₱", precision: 2)})", style: "color: red"%>
    </div>
    <div class="d-flex gap-3 mb-3">
      <%= content_tag :h6, "Net Premium: ", style: "width: 200px" %>
      <%= content_tag :h6, "#{number_to_currency(@net_premium, unit: "₱", precision: 2)}", style: "color: green"%>
    </div>
  </div>
</div>


<div class="table-responsive">
  <%= turbo_frame_tag "batches" do %>
  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>

        <th>ID</th>
        <th>Member</th>
        <th>Status</th>
        <th>Premium</th>
        <th>Coop Commission</th>
        <th>Actions</th>

      </tr>
    </thead>

    <tbody id="batches_body">
        <%= render @batches, group_remit: @group_remit %>
    </tbody>
  </table>
  <% end %>

</div>
<% console %>
<%== pagy_bootstrap_nav(@pagy) %>