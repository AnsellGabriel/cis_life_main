<%= content_tag :h1, "#{@cooperative.name} Members" %>
<div class="mb-3">
  <%= link_to "Enroll Member", new_member_path, class: "btn btn-primary"%>
</div>
<div>
  <%= form_with url: coop_members_path, method: :get do %>
    <%= text_field_tag 'filter', nil, placeholder: 'Filter by last name', class: "form-control", style: "width: auto"%>
  <% end %>
</div>

<div class="table-responsive mt-3">
  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>

      <th>ID</th>
        <%# <th>Coop Branch</th> %>
        <th>Last Name</th>
        <th>First Name</th>
        <th>Middle Name</th>
        <th>Age</th>
        <th>Birthdate</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% @filtered_members.each do |member| %>
        <tr>
        <%# <% member = coop_member.member %> 
        <td><%= member.id %></td>
        <%# <td><%= member.coop_members.branch.name %>
        <td><%= member.last_name %></td>
        <td><%= member.first_name %></td>
        <td><%= member.middle_name %></td>
        <td><%= Date.today.year - member.birth_date.year - ((Date.today.month > member.birth_date.month || (Date.today.month == member.birth_date.month && Date.today.day >= member.birth_date.day)) ? 0 : 1) %></td>
        <td><%= member.birth_date.strftime('%B %d, %Y') %></td>
    
          <td>
            <%= link_to 'View', member, class: 'btn btn-primary' %>
            <%= link_to 'Edit', edit_member_path(member), class: 'btn btn-secondary' %>
            <%= link_to 'Delete', member, data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
          </td>

        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<%== pagy_bootstrap_nav(@pagy) %>
