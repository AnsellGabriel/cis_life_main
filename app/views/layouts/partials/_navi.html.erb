<nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom py-3 mb-4">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <a class="navbar-brand <%= flex_justify_align('', 'center') %>" href="#">
        <%= image_tag 'cis_logo.png', width: 150, class: 'mb-2 mb-lg-0 me-2' %>
        <div class="" style="max-width: 500px;">
          <% if current_user %>
            <%= truncate(nav_header(current_user), length: 65) %>
          <% end %>
        </div>
      </a>

      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <% if current_user %>
          <%= link_to "Home", authenticated_root_path, class: "nav-link" %>
          
          <% if coop_user?(current_user) %>
            <%= render 'layouts/partials/nav_dropdown', title: 'Cooperative' do %>
              <%= link_to "Members", coop_members_path, class: "dropdown-item" %>
              <%= link_to "Claims Filed", index_coop_process_claims_path, class: "dropdown-item" %>
              <%= link_to "Claims Message", claim_remarks_path, class: "dropdown-item" %>            
            <% end %>
            
            <%= render 'layouts/partials/nav_dropdown', title: 'Insurance' do %>
              <% @cooperative.agreements.includes(:plan).each do |a| %>
                <% case a.plan.acronym %>
                <% when 'LPPI' %>
                  <%= link_to "LPPI", loan_insurance_group_remits_path, class: "dropdown-item" %>
                <% else %>
                  <%= link_to "GYRT", coop_agreement_path(a), class: "dropdown-item" %>
                <% end %>
              <% end %>
            <% end %>

          <% else %>
            <%= render 'layouts/partials/nav_dropdown', title: 'Claims' do %>
              <%= link_to "Submitted", index_show_process_claims_path(p: 1), class: "dropdown-item" %>
              <%= link_to "Claims Filed", index_show_process_claims_path(p: 2), class: "dropdown-item" %>
              <%= link_to "Processing", index_show_process_claims_path(p: 3), class: "dropdown-item" %>
              <%= link_to "Evaluation", index_show_process_claims_path(p: 4), class: "dropdown-item" %>
              <%= link_to "VP Evaluation", index_show_process_claims_path(p: 5), class: "dropdown-item" %>
              <%= link_to "President Evaluation", index_show_process_claims_path(p: 6), class: "dropdown-item" %>
              <li><hr class="dropdown-divider"></li>
              <%= link_to "Documents", documents_path, class: "dropdown-item" %>
              <%= link_to "Claim Type", claim_types_path, class: "dropdown-item" %>
              <%= link_to "Claims Message", claim_remarks_path, class: "dropdown-item" %>
            <% end %>

            <%= render 'layouts/partials/nav_dropdown', title: 'Treasury' do %>
              <%= link_to "Payments", payments_path, class: "dropdown-item" %>
            <% end %>

            <%= render 'layouts/partials/nav_dropdown', title: 'Underwriting' do %>
              <%= link_to "Process", process_coverages_path, class: "dropdown-item" %>
              <%= link_to "Medical Director", med_directors_home_path, class: "dropdown-item" %>
            <% end %>

            <%= render 'layouts/partials/nav_dropdown', title: 'Data Entries' do %>
              <%= link_to "Agreement", agreements_path, class: "dropdown-item" %>
              <%= link_to "EmpAgreement", emp_agreements_path, class: "dropdown-item" %>
              <%= link_to "Approver", emp_approvers_path, class: "dropdown-item" %>
              <%= link_to "Authority Levels", authority_levels_path, class: "dropdown-item" %>
              <%= link_to "Plans", plans_path, class: "dropdown-item" %>
              <%= link_to "Benefits", benefits_path, class: "dropdown-item" %>
              <li><hr class="dropdown-divider"></li>
              <%= link_to "Cooperative", cooperatives_path, class: "dropdown-item" %>
              <li><hr class="dropdown-divider"></li>
              <%= link_to "Employees", employees_path, class: "dropdown-item" %>
              <%= link_to "User Levels", user_levels_path, class: "dropdown-item" %>
              <%= link_to "Cooperative User", coop_users_path, class: "dropdown-item" %>
              <%= link_to "Agents", agents_path, class: "dropdown-item" %>
              <%= link_to "Pending Users", user_index_path, class: "dropdown-item" %>
            <% end %>

          <% end %>
          
          <%= render 'layouts/partials/nav_dropdown', title: "<i class=\"bi bi-person-circle\"></i> <small> Hi, #{current_user.userable.get_fullname}</small>".html_safe do %>
            <li class="nav-item"> <a class="nav-link" href="#"><%= current_user.email %></a> </li>
            <li class="nav-item"> <%= link_to "Edit Account", edit_user_registration_path, class: "nav-link" %></li>
            <li class="nav-item"> <%= button_to "Sign Out", destroy_user_session_path, method: :delete, class: "btn btn-sm btn-primary mx-2" %></li>
          <% end %>

        <% else %>
          <li class="nav-item"> <%= link_to "Sign Up", new_user_registration_path, class: "nav-link"  %></li>
          <li class="nav-item"> <%= link_to "Sign In", new_user_session_path, class: "nav-link"  %></li>
        <% end %>
      </ul>

    </div>
  </div>
</nav>
